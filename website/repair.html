<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title>Gruzdintuvė - Register Repair</title>
    <link rel="stylesheet" href="style.css">
</head>

<body>

<header>
    <h1><a href="index.html" style="color:white; text-decoration:none">MECHPRO Auto Repair</a></h1>
    <p>Fast • Professional • Reliable</p>
</header>

<nav>
    <a href="index.html">Home</a>
    <a href="services.html">Services</a>
    <a href="diagnostics.html">Diagnostics</a>
    <a href="contacts.html">Contacts</a>
    <a href="repair.html">Repair Registration</a>
</nav>
  </div>
</header>


<!-- Page container -->
<div class="container">
  <div class="card">
    <h1 style="text-align:center; font-size:40px; margin:6px 0 12px">Registracija į servisą</h1>
    <p style="text-align:center; color:#555; margin-top:0">Užpildykite formą žemiau — mes susisieksime per 2 darbo valandas</p>
  </div>

  <div class="card" style="display:grid; grid-template-columns: 1fr 480px; gap:18px; align-items:start;">
    <!-- LEFT: FORM -->
    <div>
      <form id="repairForm">
        <div style="display:grid; grid-template-columns: 1fr 1fr; gap:12px;">
          <input id="firstName" placeholder="Vardas" required maxlength="12"/>
          <input id="lastName" placeholder="Pavardė" required maxlength="12"/>
          <input id="plate" placeholder="Valstybinis numeris (pvz. ABC123)" required maxlength="10"/>
          <input id="phone" placeholder="Tel. numeris (pvz. 37061234567)" required maxlength="12" />
        </div>

        <div style="margin-top:12px;">
          <label style="font-weight:700; display:block; margin-bottom:8px">Pasirinkite simptomus</label>
          <label><input type="checkbox" name="symptom" value="strange_noise"> Neįprasti garsai</label><br>
          <label><input type="checkbox" name="symptom" value="warning_light"> Įspėjamieji pranešimai prietaisų skydelyje</label><br>
          <label><input type="checkbox" name="symptom" value="hard_start"> Sunkiai užsiveda</label><br>
          <label><input type="checkbox" name="symptom" value="vibrations"> Vibracijos vairuojant</label><br>
          <label><input type="checkbox" name="symptom" value="overheating"> Variklio perkaitimas</label><br>
          <label><input type="checkbox" name="symptom" value="brake_noise"> Stabdžių triukšmas</label><br>
        </div>

        <div style="margin-top:12px; display:flex; gap:12px; align-items:center;">
          <label style="display:flex; align-items:center; gap:8px;">
            <input type="checkbox" id="pickupOpt" /> Reikia pasiimti automobilį (pickup)
          </label>
        </div>

        <div style="margin-top:12px;">
          <label style="font-weight:700; display:block; margin-bottom:8px">Papildoma informacija</label>
          <textarea id="description" rows="6" placeholder="Trumpas paaiškinimas..."></textarea>
        </div>

        <!-- hidden field storing selected car area -->
        <input type="hidden" id="selectedArea" />

        <div style="margin-top:14px; display:flex; gap:12px;">
          <button type="submit" style="background:#1f8dff; color:#fff; border:none; padding:10px 14px; border-radius:6px; cursor:pointer;">Siųsti registraciją</button>
          <button type="button" onclick="resetForm()" style="background:#eee; border:1px solid #ddd; padding:10px 14px; border-radius:6px; cursor:pointer;">Išvalyti</button>
        </div>
      </form>

      <div id="formMsg" style="margin-top:12px; display:none;"></div>
    </div>

    <!-- RIGHT: Car top-down selector + optional thumbnail -->
    <aside>
      <div style="margin-bottom:12px; font-weight:700">Žemėlapis: pažymėkite vietą</div>

      <div class="car-top card">
        <!-- The CSS shapes (see style.css) -->
        <div class="car-body">
          <button class="hotspot" data-area="engine" title="Variklis">Engine</button>

          <div class="row">
            <button class="hotspot" data-area="front-left" title="Pr. kairė">FL</button>
            <button class="hotspot" data-area="front-right" title="Pr. dešinė">FR</button>
          </div>

          <div class="row">
            <button class="hotspot" data-area="center-left" title="Vidurys kairė">CL</button>
            <button class="hotspot" data-area="center-right" title="Vidurys dešinė">CR</button>
          </div>

          <div class="row">
            <button class="hotspot" data-area="rear-left" title="Gal. kairė">RL</button>
            <button class="hotspot" data-area="rear-right" title="Gal. dešinė">RR</button>
          </div>

          <button class="hotspot" data-area="exhaust" title="Išmetimas">Exh</button>
        </div>
      </div>

      <div style="margin-top:14px;" class="card">
        <div style="font-weight:700">Pasirinkta vieta:</div>
        <div id="pickedArea" class="small-muted" style="margin-top:6px">Nenurodyta</div>
      </div>

      <div style="margin-top:14px" class="card">
        <div style="font-weight:700">sample</div>
        <img src="sample.jpg" alt="sample" style="width:100%; border-radius:6px; margin-top:8px;"/>
        <div class="small-muted" style="margin-top:8px">Important!!!</div>
      </div>
    </aside>
  </div>
</div>

<!-- Login modal (shared) -->
<div id="loginModal" class="modal" style="display:none">
  <div class="modal-card card">
    <h3>Login (prototype)</h3>
    <input id="loginUsername" placeholder="Username" />
    <input id="loginPassword" placeholder="Password" type="password" />
    <div style="display:flex; gap:8px;">
      <button onclick="loginSimple()" style="flex:1; padding:8px">Login</button>
      <button onclick="closeLoginModal()" style="flex:1; padding:8px">Cancel</button>
    </div>
    <p class="small-muted" style="margin-top:10px">Any username + password works. This creates a local user in the browser (localStorage).</p>
  </div>
</div>

<script src="app.js"></script>

<!-- page specific JS -->
<script>
  // ensure header initializes
  document.addEventListener('DOMContentLoaded', () => {
    // initApp from app.js already runs; ensure UI hookups
    initRepairPage();
  });

  function initRepairPage() {
    // hotspots
    document.querySelectorAll('.car-top .hotspot').forEach(btn => {
      btn.addEventListener('click', () => {
        // clear previous selection visuals
        document.querySelectorAll('.car-top .hotspot.selected').forEach(x => x.classList.remove('selected'));
        btn.classList.add('selected');
        const area = btn.getAttribute('data-area');
        document.getElementById('selectedArea').value = area;
        document.getElementById('pickedArea').textContent = area;
      });
    });

    // phone input: only digits allowed
    const phone = document.getElementById('phone');
    phone.addEventListener('input', () => {
      phone.value = phone.value.replace(/[^\d]/g, '').slice(0, 12);
    });

    // form submit
    document.getElementById('repairForm').addEventListener('submit', (e) => {
      e.preventDefault();
      submitRepairForm();
    });
  }

  function submitRepairForm() {
    const firstName = document.getElementById('firstName').value.trim();
    const lastName = document.getElementById('lastName').value.trim();
    const plate = document.getElementById('plate').value.trim();
    const phone = document.getElementById('phone').value.trim();
    const desc = document.getElementById('description').value.trim();
    const pickup = !!document.getElementById('pickupOpt').checked;
    const selectedArea = document.getElementById('selectedArea').value || null;

    if (!firstName || !lastName || !plate || !phone) {
      showFormMsg('Please fill name, last name, plate and phone.', true);
      return;
    }

    // gather symptoms
    const symptoms = Array.from(document.querySelectorAll('input[name="symptom"]:checked')).map(c => c.value);

    const req = {
      id: 'r' + Date.now(),
      firstName, lastName, plate, phone, desc, pickup, selectedArea, symptoms,
      createdAt: Date.now()
    };

    // save to localStorage array 'repairRequests'
    const existing = JSON.parse(localStorage.getItem('repairRequests') || '[]');
    existing.push(req);
    localStorage.setItem('repairRequests', JSON.stringify(existing));

    // feedback
    showFormMsg('Registracija išsaugota. Mes susisieksime netrukus. (ID: ' + req.id + ')', false);

    // reset (keep selected area? we'll clear everything)
    resetForm();
  }

  function showFormMsg(text, isError) {
    const el = document.getElementById('formMsg');
    el.style.display = 'block';
    el.style.padding = '12px';
    el.style.borderRadius = '6px';
    el.style.background = isError ? '#ffe3e3' : '#e6ffed';
    el.style.color = isError ? '#8b0000' : '#0b6b2a';
    el.textContent = text;
    // hide after 6s
    setTimeout(() => { el.style.display = 'none'; }, 6000);
  }

  function resetForm() {
    document.getElementById('repairForm').reset();
    document.getElementById('selectedArea').value = '';
    document.getElementById('pickedArea').textContent = 'Nenurodyta';
    document.querySelectorAll('.car-top .hotspot.selected').forEach(x => x.classList.remove('selected'));
    document.getElementById('formMsg').style.display = 'none';
  }
</script>


</body>
</html>
